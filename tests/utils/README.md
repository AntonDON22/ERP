# Utils Tests

Тесты для утилит и вспомогательных функций системы.

## Файлы тестов

### timeUtils.test.ts
Тестирует работу с московским временем:
- **UTC → MSK конвертация** (+3 часа)
- **Переходы через полночь**
- **Форматирование для документов**
- **Смена года/месяца**
- **Часовые пояса**

**Покрытие**: 100% функций времени

## Критические функции

### formatDateForDocument()
Форматирует дату для именования документов:
- Вход: `Date | string`
- Выход: `"DD.MM"` в московском времени
- Пример: `"02.07"` для 2 июля

**Особенности:**
- Автоматический перевод в MSK
- Правильная обработка переходов через полночь
- Защита от некорректных дат

### formatTimeForDocument()
Форматирует время для логов:
- Вход: `Date | string`
- Выход: `"HH:MM:SS"` в московском времени
- Пример: `"15:30:45"`

**Особенности:**
- 24-часовой формат
- Ведущие нули
- MSK часовой пояс

### convertToMoscowTime()
Преобразует UTC в московское время:
- Вход: `Date | string` (UTC)
- Выход: `Date` (MSK)
- Сдвиг: +3 часа

## Запуск тестов

```bash
# Все utils тесты
npx vitest run tests/utils/

# Конкретный файл
npx vitest run tests/utils/timeUtils.test.ts

# С детальным выводом
npx vitest run tests/utils/ --reporter=verbose
```

## Тествые сценарии

### Граничные случаи
- Переход 23:59 → 00:00
- Смена года (31.12 → 01.01)
- Смена месяца (28.02 → 01.03)
- Високосные года

### Валидация входных данных
- Некорректные строки
- `null` и `undefined`
- Неправильные объекты Date
- Крайние значения (1900, 2100)

### Производительность
- Массовые преобразования
- Повторные вызовы
- Кеширование результатов

## Важность для системы

Функции времени критически важны для:
- **Именования документов** (уникальность)
- **Логирования** (правильная хронология)  
- **Отчетности** (корректные даты)
- **Пользовательского интерфейса** (понятные форматы)