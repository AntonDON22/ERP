# üîç –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–∏–π

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã

### –†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫):
- `server/storage.ts`: 1142 —Å—Ç—Ä–æ–∫–∏ - **–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞**
- `tests/integration/system.test.ts`: 547 —Å—Ç—Ä–æ–∫
- `server/services/transactionService.ts`: 406 —Å—Ç—Ä–æ–∫  
- `shared/schema.ts`: 370 —Å—Ç—Ä–æ–∫
- `client/src/hooks/useTypedQuery.ts`: 361 —Å—Ç—Ä–æ–∫–∞

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –û–≥—Ä–æ–º–Ω—ã–π —Ñ–∞–π–ª storage.ts (1142 —Å—Ç—Ä–æ–∫–∏)
**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Ñ–∞–π–ª —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–æ–¥–æ–º
**–í–ª–∏—è–Ω–∏–µ**: –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –º–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è
**–†–µ—à–µ–Ω–∏–µ**: –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –º–æ–¥—É–ª–∏ –ø–æ –¥–æ–º–µ–Ω–∞–º

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ –≤—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Redis –∫–µ—à
**–í–ª–∏—è–Ω–∏–µ**: –õ–∏—à–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î
**–†–µ—à–µ–Ω–∏–µ**: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### 3. N+1 –ø—Ä–æ–±–ª–µ–º—ã –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ —Ü–∏–∫–ª–∞—Ö
**–í–ª–∏—è–Ω–∏–µ**: –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ API –≤ 2-5 —Ä–∞–∑
**–†–µ—à–µ–Ω–∏–µ**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ JOIN –∑–∞–ø—Ä–æ—Å—ã

## üí° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### A. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

#### 1. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ storage.ts ‚Üí Domain Services
```
server/storage/
‚îú‚îÄ‚îÄ userStorage.ts
‚îú‚îÄ‚îÄ productStorage.ts  
‚îú‚îÄ‚îÄ inventoryStorage.ts
‚îú‚îÄ‚îÄ documentStorage.ts
‚îî‚îÄ‚îÄ index.ts (unified export)
```

#### 2. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```typescript
class ApiErrorHandler {
  static handleDatabaseError(error: unknown): ApiError
  static handleValidationError(error: ZodError): ApiError
  static handleCacheError(error: unknown): void
}
```

#### 3. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CRUD —Å–µ—Ä–≤–∏—Å
```typescript
abstract class BaseService<T, CreateT> {
  abstract create(data: CreateT): Promise<T>
  abstract getById(id: number): Promise<T | undefined>
  abstract update(id: number, data: Partial<CreateT>): Promise<T>
  abstract delete(id: number): Promise<boolean>
}
```

### B. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### 1. Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
```typescript
// –í–º–µ—Å—Ç–æ —Ü–∏–∫–ª–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
async deleteMultiple(ids: number[]): Promise<boolean> {
  return db.delete(table).where(inArray(table.id, ids))
}
```

#### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQL –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∏–Ω–¥–µ–∫—Å—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å EXISTS –≤–º–µ—Å—Ç–æ COUNT –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å LIMIT –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

#### 3. Lazy loading –¥–ª—è React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```typescript
const HeavyComponent = lazy(() => import('./HeavyComponent'))
```

### C. –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

#### 1. –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ magic numbers/strings
```typescript
const CACHE_TTL = {
  INVENTORY: 60,
  PRODUCTS: 300,
  STATIC_DATA: 3600
} as const
```

#### 2. –¢–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö API responses
```typescript
interface ApiResponse<T> {
  data: T
  success: boolean
  message?: string
  meta?: PaginationMeta
}
```

#### 3. –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç
```typescript
class DateHelper {
  static toMoscowTime(date: Date): string
  static fromISOString(iso: string): Date
  static formatForDisplay(date: Date): string
}
```

## üéØ –ü–ª–∞–Ω –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (2-3 —á–∞—Å–∞)
1. ‚úÖ –†–∞–∑–¥–µ–ª–∏—Ç—å storage.ts –Ω–∞ –¥–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å N+1 –ø—Ä–æ–±–ª–µ–º—ã –≤ inventory –∑–∞–ø—Ä–æ—Å–∞—Ö  
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

### –§–∞–∑–∞ 2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (3-4 —á–∞—Å–∞)  
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å BaseService –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ CRUD
2. ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
3. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§–∞–∑–∞ 3: –ü–æ–ª–∏—Ä–æ–≤–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏ (1-2 —á–∞—Å–∞)
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ç–∏–ø—ã –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **API —Å–∫–æ—Ä–æ—Å—Ç—å**: —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 40-60%  
- **–†–∞–∑–º–µ—Ä bundle**: —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 20-30%
- **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏**: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ 25-35%

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å:
- **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤**: —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∫—Ä—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ 2-3 —Ä–∞–∑–∞
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**: —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞ 50-70%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏**: —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–æ 95%+

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è**: 100% TypeScript strict mode
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

1. **Bundle Analyzer**: –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–∞ —Å–±–æ—Ä–∫–∏
2. **Performance Metrics**: –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API  
3. **Memory Profiler**: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
4. **Database Query Monitor**: –∞–Ω–∞–ª–∏–∑ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

*–ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω: 2 –∏—é–ª—è 2025*  
*–°–∏—Å—Ç–µ–º–∞: ERP —Å PostgreSQL + Redis + React*
*–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤ –∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏*