# Services Tests

Тесты для бизнес-логики и сервисов ERP системы.

## Файлы тестов

### documentStatusService.test.ts
Тестирует систему статусов документов:
- **draft → posted** (проведение документов)
- **posted → draft** (отмена документов) 
- Создание/удаление inventory записей
- Транзакционная целостность

**Покрытие**: 100% критических операций

### inventoryService.test.ts
Тестирует управление остатками товаров:
- Получение остатков по складам
- Расчет доступного количества
- Фильтрация по складам
- Обработка пустых данных

**Покрытие**: >90% функциональности

### dataCleanerService.test.ts
Тестирует очистку и валидацию данных:
- Удаление валют (₽, $, €, руб.)
- Удаление единиц (г, кг, мм, см, м)
- Очистка разделителей
- Обработка Excel форматов

**Покрытие**: 100% функций очистки

## Запуск тестов

```bash
# Все service тесты
npx vitest run tests/services/

# Конкретный файл
npx vitest run tests/services/documentStatusService.test.ts

# С детальным выводом
npx vitest run tests/services/ --reporter=verbose
```

## Структура тестов

Каждый тест следует структуре:
1. **Описание функциональности**
2. **Настройка моков и данных**
3. **Выполнение теста**
4. **Проверка результатов**
5. **Очистка ресурсов**

## Важные моки

- **Database**: Drizzle ORM моки
- **Transactions**: Транзакционные операции
- **Logging**: Система логирования